<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <title>Daily Productivity Form</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Noto Sans Thai', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .header {
      text-align: center;
      color: white;
      margin-bottom: 30px;
      animation: fadeInDown 0.6s ease-out;
    }
    
    .header h1 {
      font-size: 2.5em;
      font-weight: 700;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
    }
    
    .header p {
      font-size: 1.1em;
      font-weight: 300;
      opacity: 0.95;
    }
    
    .mode-switch {
      text-align: center;
      margin-bottom: 24px;
      padding: 12px;
      background: white;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      animation: fadeInUp 0.6s ease-out;
    }
    
    .btn {
      padding: 12px 20px;
      border-radius: 12px;
      border: 2px solid #e0e0e0;
      background: white;
      cursor: pointer;
      font-family: 'Noto Sans Thai', sans-serif;
      font-size: 16px;
      font-weight: 500;
      transition: all 0.3s ease;
      margin: 0 5px;
    }
    
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    
    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .btn.active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-color: transparent;
    }
    
    .btn.primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-color: transparent;
    }
    
    .btn.danger {
      background: #fff0f0;
      color: #e53e3e;
      border-color: #feb2b2;
    }
    
    .btn.secondary {
      background: #f7fafc;
      color: #4a5568;
      border-color: #e2e8f0;
    }
    
    .form-card {
      background: white;
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      animation: fadeInUp 0.8s ease-out;
    }
    
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 25px;
    }
    
    .form-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    label {
      font-weight: 600;
      color: #333;
      font-size: 0.95em;
    }
    
    input, select, textarea {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      font-family: 'Noto Sans Thai', sans-serif;
      font-size: 16px;
      background: white;
      transition: all 0.3s ease;
    }
    
    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }
    
    textarea {
      resize: vertical;
      min-height: 80px;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 25px 0;
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }
    
    th, td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #f0f0f0;
    }
    
    th {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      font-weight: 600;
    }
    
    tr:last-child td {
      border-bottom: none;
    }
    
    tr:hover {
      background: #f7fafc;
    }
    
    .actions {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      margin-top: 25px;
    }
    
    .hidden {
      display: none !important;
    }
    
    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      animation: fadeIn 0.3s ease-out;
    }
    
    .modal.show {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .modal-content {
      background: white;
      border-radius: 20px;
      padding: 40px;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      animation: slideUp 0.3s ease-out;
      text-align: center;
    }
    
    .modal-icon {
      font-size: 4em;
      margin-bottom: 20px;
    }
    
    .modal-title {
      font-size: 1.8em;
      font-weight: 700;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 15px;
    }
    
    .modal-message {
      font-size: 1.1em;
      color: #666;
      margin-bottom: 30px;
    }
    
    /* Preview Styles */
    #preview {
      display: none;
    }
    
    #preview.show {
      display: block;
    }
    
    .preview-header {
      font-size: 1.5em;
      font-weight: 600;
      color: #333;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 2px solid #f0f0f0;
    }
    
    .preview-info {
      background: #f7fafc;
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 20px;
    }
    
    .preview-info p {
      margin: 8px 0;
      font-size: 1.05em;
    }
    
    .preview-info strong {
      color: #667eea;
    }
    
    /* Manage Section */
    #manageSection {
      background: white;
      padding: 30px;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      animation: fadeInUp 0.8s ease-out;
    }
    
    .search-box {
      display: flex;
      gap: 12px;
      align-items: end;
      margin: 25px 0;
    }
    
    .search-box > div {
      flex: 1;
    }
    
    .data-table {
      overflow-x: auto;
      margin-top: 20px;
    }
    
    .data-table textarea {
      min-height: 60px;
    }
    
    .data-table input[type="number"] {
      width: 100px;
    }
    
    .loading-spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255,255,255,0.3);
      border-top-color: white;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }
    
    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes fadeInDown {
      from {
        opacity: 0;
        transform: translateY(-30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(50px) scale(0.9);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      .header h1 {
        font-size: 1.8em;
      }
      
      .grid {
        grid-template-columns: 1fr;
      }
      
      .actions {
        flex-direction: column;
      }
      
      .btn {
        width: 100%;
      }
      
      .modal-content {
        padding: 30px 20px;
      }
      
      table {
        font-size: 14px;
      }
      
      th, td {
        padding: 8px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üìä ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° Productivity ‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</h1>
      <p>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</p>
    </div>

    <!-- Mode Switch -->
    <div class="mode-switch">
      <button type="button" class="btn active" id="btnModeCreate" onclick="showMode('create')">
        üìù ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
      </button>
      <button type="button" class="btn" id="btnModeManage" onclick="showMode('manage')">
        üîç ‡∏î‡∏π/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç/‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
      </button>
    </div>

    <!-- Create Form Section -->
    <div id="createSection">
      <form id="productivity-form" class="form-card" autocomplete="off">
        <div class="grid">
          <div class="form-group">
            <label>‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</label>
            <input name="name" required>
          </div>
          <div class="form-group">
            <label>‡∏ù‡πà‡∏≤‡∏¢/‡πÅ‡∏ú‡∏ô‡∏Å</label>
            <input name="department" required>
          </div>
          <div class="form-group">
            <label>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô/‡∏á‡∏≤‡∏ô</label>
            <input name="unit" required>
          </div>
          <div class="form-group">
            <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å</label>
            <input id="date" name="date" placeholder="‡∏ß‡∏±‡∏ô/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ" required>
          </div>
          <div class="form-group">
            <label>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô)</label>
            <input id="month" name="month" placeholder="‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô" required>
          </div>
        </div>

        <table>
          <thead>
            <tr>
              <th style="width:22%">Key Project</th>
              <th style="width:26%">Key Activity</th>
              <th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</th>
              <th style="width:12%">Manday</th>
              <th style="width:8%">‡∏•‡∏ö</th>
            </tr>
          </thead>
          <tbody id="rows"></tbody>
        </table>

        <div class="actions">
          <button type="button" class="btn secondary" id="btnAdd">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</button>
          <button type="button" class="btn secondary" id="btnPreview">‡∏û‡∏£‡∏µ‡∏ß‡∏¥‡∏ß</button>
          <button type="submit" class="btn primary" id="btnSubmit">
            <span id="submitText">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
            <span id="submitLoading" class="loading-spinner hidden"></span>
          </button>
        </div>
      </form>

      <!-- Preview Section -->
      <div id="preview" class="form-card">
        <div class="preview-header">üìã ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á</div>
        <div class="preview-info" id="previewBody"></div>
        <div class="actions">
          <button type="button" class="btn primary" id="btnConfirm">‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏™‡πà‡∏á</button>
          <button type="button" class="btn secondary" id="btnBack">üîÑ ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
        </div>
      </div>
    </div>

    <!-- Manage Section -->
    <div id="manageSection" class="hidden">
      <h3 style="color:#333; margin-bottom:20px;">üìä ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h3>
      
      <div class="search-box">
        <div>
          <label>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</label>
          <input type="text" id="searchName" placeholder="‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì">
        </div>
        <button type="button" class="btn primary" onclick="loadMyData()">üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
      </div>

      <div id="dataList"></div>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="modal">
      <div class="modal-content">
        <div class="modal-icon">‚úÖ</div>
        <div class="modal-title">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</div>
        <div class="modal-message" id="successMessage">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å 0 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>
        <button class="btn primary" onclick="closeSuccessModal()">‡∏õ‡∏¥‡∏î</button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/th.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/plugins/monthSelect/index.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/plugins/monthSelect/style.css">
  <script>
    // ===== CONFIG =====
    const MAKE_WEBHOOK_URL = 'https://hook.us2.make.com/q7mp7j5z5ipz7so4p8mclhh83bbm5esh';
    const SHARED_SECRET = 'olala567';
    const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzUqWym78BL1vysGNvRjO5JYXy46vXcSvdXrkLbHoUqNUFGVwii4Q-C3ssDqRGSPDZd/exec';

    // ===== Activity Map =====
    const activityMap = {
      "Y1 Engagement": [
        "Y1-1 Survey Engagement",
        "Y1-2 Engagement & Communication & Training Plan ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏õ‡∏Å‡∏ï‡∏¥‡∏ô‡∏¥‡πÄ‡∏ó‡∏®‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà",
        "Y1-2 Engagement & Communication & Training Plan ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£ ‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤ ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏à‡∏±‡∏î‡∏Å‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏° ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏ô"
      ],
      "Y2 Career Development": [
        "Y2-1 ‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô Competency",
        "Y2-2 HRD Training Development Language Proficiency Development Program",
        "Y2-2 HRD Training Development Functional Competency based Development Program",
        "Y2-2 HRD Training Development IT Proficiency Development Program",
        "Y2-2 HRD Training Development ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á Career Development"
      ],
      "Y3 Quality Management System": [
        "Y3-1 ‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö ISO 9001",
        "Y3-1 ISO 9001 Meeting ‡∏™‡∏Ñ.",
        "Y3-1 ISO 9001 Document Control ‡πÅ‡∏•‡∏∞ QM/PM/I/F ‡∏£‡∏ß‡∏° (XX-NS-MG-XXX)",
        "Y3-1 ISO 9001 e-CAR/PAR System",
        "Y3-1 ISO 9001 Management Review",
        "Y3-1 ISO 9001 Internal Audit",
        "Y3-1 ISO 9001 External Audit",
        "Y3-1 ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏£‡∏∞‡∏ö‡∏ö ISO 9001 ‡∏ï‡∏≤‡∏°‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏õ‡∏µ",
        "Y3-1 ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° ISO 9001 ‡πÅ‡∏•‡∏∞ ISO 45001 ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏ù‡πà‡∏≤‡∏¢ HROD",
        "Y3-2 ISO 17025 ‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤",
        "Y3-2 ISO 17025 Document Control",
        "Y3-2 ISO 17025 Internal Audit",
        "Y3-2 ISO 17025 External Audit",
        "Y3-2 ISO 17025 ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö ISO 17025",
        "Y3-3 IS0 13485 ‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤",
        "Y3-3 IS0 13485 Document Control",
        "Y3-3 IS0 13485 Internal Audit",
        "Y3-3 IS0 13485 External Audit",
        "Y3-3 IS0 13485 ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö IS0 13485",
        "Y3-4 HRD Training Development ‡∏à‡∏±‡∏î‡∏Å‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö ISO 9001",
        "Y3-4 HRD Training Development ‡∏à‡∏±‡∏î‡∏Å‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö ISO 45001 ‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢",
        "Y3-4 HRD Training Development ‡∏à‡∏±‡∏î‡∏Å‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö ISO 17025",
        "Y3-4 HRD Training Development ‡∏à‡∏±‡∏î‡∏Å‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö ISO 13485",
        "Y3-4 HRD Training Development ‡∏à‡∏±‡∏î‡∏Å‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏°‡∏≤‡∏ï‡∏£‡∏Å‡∏≤‡∏£‡∏≠‡∏∑‡πà‡∏ô‡πÜ",
        "Y3-5 KPI+SLA ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡πÅ‡∏•‡∏∞‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏• KPI ‡πÅ‡∏•‡∏∞ SLA",
        "Y3-5 KPI+SLA ‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤",
        "Y3-5 KPI+SLA ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö KPI+SLA",
        "Y3-6 ICS/ECS ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö ICS/ECS"
      ],
      "Y4 HR Strategy & Process Improvement": [
        "Y4-1 ‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ HR Strategy ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£/‡∏Å‡∏£‡∏°‡∏ö‡∏±‡∏ä‡∏ä‡∏µ‡∏Å‡∏•‡∏≤‡∏á/‡∏Å‡∏û‡∏£.",
        "Y4-2 ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á ‡∏†‡∏≤‡∏¢‡πÉ‡∏ï‡πâ HR Plan / HRD Plan",
        "Y4-3 BSC ‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° BSC Core Team",
        "Y4-3 BSC Lag KPIs ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏î‡πâ‡∏≤‡∏ô HR (‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡πà‡∏á‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå)",
        "Y4-3 BSC & KPI reporting ‡∏™‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£",
        "Y4-3 BSC Lead KPI ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö HROD ‡∏™‡∏ß‡∏ó‡∏ä. (Deployment HROD ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Ø + ‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏ï‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°)",
        "Y4-3 BSC ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏µ‡πà‡∏ï‡∏≠‡∏ö‡πÅ‡∏ú‡∏ô‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ (‡πÄ‡∏ä‡πà‡∏ô BCG / Corebusiness)",
        "Y4-4 ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ iStyle ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ / ‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£ /‡∏à‡∏±‡∏î‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á",
        "Y4-4 ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ iStyle ‡∏à‡∏±‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°‡πÉ‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á",
        "Y4-4 ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ iStyle ‡∏à‡∏±‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£",
        "Y4-4 ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ iStyle ‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£",
        "Y4-4 ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ iStyle ‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏î‡∏µ‡πÄ‡∏î‡πà‡∏ô",
        "Y4-4 ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ iStyle ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ iStyle ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏ù‡πà‡∏≤‡∏¢ HROD",
        "Y4-5 Risk Management ‡∏£‡∏∞‡∏î‡∏±‡∏ö ‡∏™‡∏ß‡∏ó‡∏ä.",
        "Y4-5 Risk Management ‡∏£‡∏∞‡∏î‡∏±‡∏ö ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏™‡∏≤‡∏¢‡∏á‡∏≤‡∏ô",
        "Y4-5 Risk Management ‡∏à‡∏±‡∏î‡∏ó‡∏≥ BTD ‡∏™‡∏Ñ. ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞",
        "Y4-6 ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ 5‡∏™. ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà 5‡∏™ ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà 1 ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ",
        "Y4-6 ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ 5‡∏™. ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà 5‡∏™ ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà 2 ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ",
        "Y4-6 ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ 5‡∏™. ‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Ñ‡∏ì‡∏∞‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà 5‡∏™",
        "Y4-6 ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ 5‡∏™. ‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏á‡∏≤‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° 5‡∏™",
        "Y4-6 ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ 5‡∏™. ‡∏à‡∏±‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏∞‡∏™‡∏≤‡∏á‡∏ï‡∏π‡πâ‡∏£‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô",
        "Y4-6 ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ 5‡∏™. ‡∏à‡∏±‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° Big Cleaning Day",
        "Y4-6 ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ 5‡∏™. ‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô",
        "Y4-6 ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ 5‡∏™. ‡∏à‡∏±‡∏î‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• 5‡∏™.",
        "Y4-6 ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ 5‡∏™. ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏•‡∏≤‡∏¢‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£",
        "Y4-6 ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ 5‡∏™. ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ 5‡∏™.",
        "Y4-6 ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ 5‡∏™. ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ 5‡∏™. ‡∏Ç‡∏≠‡∏á HROD",
        "Y4-7 VOU ‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ ‡πÄ‡∏ä‡πà‡∏ô ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞ ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏ô",
        "Y4-7 VOU ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÅ‡∏•‡∏∞‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏ô (‡∏£‡∏≤‡∏¢ case)",
        "Y4-7 VOU ‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏´‡∏≤‡∏£‡∏∑‡∏≠‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡∏û‡∏ö‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ (‡∏£‡∏≤‡∏¢ case)",
        "Y4-7 VOU Reporting: ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏• ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£",
        "Y4-7 VOU ‡πÄ‡∏™‡∏ô‡∏≠‡∏ï‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ VOU",
        "Y4-7 VOU ‡πÄ‡∏™‡∏ô‡∏≠‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° MCM (‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)",
        "Y4-8 Productivity ‡∏™‡∏£‡∏∏‡∏õ Input ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£ ‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏õ‡∏±‡∏ô‡∏™‡πà‡∏ß‡∏ô",
        "Y4-8 Productivity ‡∏à‡∏±‡∏î‡∏ó‡∏≥‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏≤‡∏á Productivity",
        "Y4-8 Productivity ‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏î‡πâ‡∏≤‡∏ô Productivity",
        "Y4-8 Productivity ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô Productivity ‡∏Ç‡∏≠‡∏á‡∏ù‡πà‡∏≤‡∏¢ HROD",
        "Y4-8 Productivity ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö Productivity"
      ],
      "Y5 Leadership Development and Succession Plan": [
        "Y5-1 ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö Succession plan/PPR",
        "Y5-1 ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö Succession plan/PPR",
        "Y5-2 ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö Middle Management Development",
        "Y5-2 ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö Middle Management Development",
        "Y5-3 ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö Top Management Development",
        "Y5-3 ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö Top Management Development"
      ],
      "Y6 Meeting": [
        "Y6-1 ‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° MCM",
        "Y6-2 ‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° OM",
        "Y6-3 ‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° HR Top / XAB",
        "Y6-4 ‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏≠‡∏ô‡∏∏‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•",
        "Y6-5 ‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° HROD/‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏á‡∏≤‡∏ô/‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô/HRM",
        "Y6-6 ‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á",
        "Y6-7 ‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° PPR/Pre PIP/PIP/BATTLE ‡πÅ‡∏•‡∏∞‡∏≠‡∏∑‡πà‡∏ô‡πÜ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏á‡∏≤‡∏ô"
      ],
      "Y7 Report": [
        "Y7-1 ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô PMQA / TQA ‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏Ç‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏†‡∏≤‡∏Ñ‡∏£‡∏±‡∏ê",
        "Y7-2 ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô ITA",
        "Y7-3 ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏ò‡∏£‡∏£‡∏°‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™",
        "Y7-4 ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô PowerBI",
        "Y7-5 Current Employee Report",
        "Y7-6 ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô Research Course Report",
        "Y7-7 ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô HR Executive Report",
        "Y7-8 ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô IC Score",
        "Y7-9 ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô Safety Report"
      ],
      "Y8 Performance management": [
        "Y8-1 ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á (‡∏£‡∏ß‡∏°‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÄ‡∏Å‡∏ì‡∏ë‡πå/‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏£‡∏∞‡∏ö‡∏ö)",
        "Y8-2 ‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏á‡∏≤‡∏ô",
        "Y8-3 ‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏Ñ‡∏ô‡∏ï‡∏≤‡∏° Performance management (Top&Bottom)",
        "Y8-4 ‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô IADP/‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•/‡∏Å‡∏≤‡∏£‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ/‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏Å‡∏£‡∏≠‡∏ö‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£/Special Adjustment"
      ],
      "Y9 Organization & Role Profile": [
        "Y9-1 ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏≤‡∏£ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Ñ‡∏ì‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Å‡∏•‡∏±‡πà‡∏ô‡∏Å‡∏£‡∏≠‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á",
        "Y9-1 ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏≤‡∏£ ‡∏à‡∏±‡∏î‡∏ó‡∏≥‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° ‡∏Ñ‡∏ì‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Å‡∏•‡∏±‡πà‡∏ô‡∏Å‡∏£‡∏≠‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á (FD update + ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡πà‡∏≤‡∏á‡∏≤‡∏ô)",
        "Y9-2 ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á",
        "Y9-3 ‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Å‡∏•‡∏±‡πà‡∏ô‡∏Å‡∏£‡∏≠‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡πà‡∏≤‡∏á‡∏≤‡∏ô"
      ],
      "‡∏á‡∏≤‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢": [
        "iService",
        "HRSS",
        "‡∏á‡∏≤‡∏ô‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡∏®‡∏π‡∏ô‡∏¢‡πå",
        "‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ù‡πà‡∏≤‡∏¢ / ‡∏á‡∏≤‡∏ô",
        "‡∏á‡∏≤‡∏ô‡∏≠‡∏∑‡πà‡∏ô ‡πÜ"
      ],
      "‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏≠‡∏∑‡πà‡∏ô‡πÜ / ‡∏≠‡∏ö‡∏£‡∏°‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏ï‡πà‡∏≤‡∏á‡πÜ": [
        "‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° ISO 27001 (IT)",
        "‡∏≠‡∏ö‡∏£‡∏°‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£ ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö ISO ‡πÅ‡∏•‡∏∞‡∏°‡∏≤‡∏ï‡∏£‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á ‡πÄ‡∏ä‡πà‡∏ô Transition Version ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏ô",
        "‡∏≠‡∏ö‡∏£‡∏°‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏õ‡∏Å‡∏ï‡∏¥‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•/‡∏î‡∏±‡∏ö‡πÄ‡∏û‡∏•‡∏¥‡∏á",
        "NSTDA Day / ‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡∏™‡∏≤‡∏¢‡∏á‡∏≤‡∏ô / Comunication Day",
        "‡∏≠‡∏ö‡∏£‡∏°‡∏≠‡∏∑‡πà‡∏ô‡πÜ",
        "‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏á‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á HROD"
      ]
    };

    const f = document.getElementById('productivity-form');
    const tbody = document.getElementById('rows');
    let isSending = false;
    let datePickerInstance = null;
    let monthPickerInstance = null;

    // ===== Initialize =====
    document.addEventListener('DOMContentLoaded', () => {
      initializeDatePicker();
      initializeMonthPicker();
      addRow();
    });

    // ===== Date Picker (‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å) =====
    function initializeDatePicker() {
      datePickerInstance = flatpickr('#date', {
        dateFormat: 'd/m/Y',
        locale: 'th',
        defaultDate: 'today',
        disableMobile: true,
        allowInput: true
      });
    }

    // ===== Month Picker (‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô - ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô ‡∏û.‡∏®.) =====
    function initializeMonthPicker() {
      const monthInput = document.getElementById('month');
      
      monthPickerInstance = flatpickr('#month', {
        locale: 'th',
        plugins: [
          new monthSelectPlugin({
            shorthand: false,
            dateFormat: 'Y-m',
            altFormat: 'F Y'
          })
        ],
        disableMobile: true,
        onChange: function(selectedDates, dateStr, instance) {
          if (selectedDates.length > 0) {
            const date = selectedDates[0];
            const thaiYear = date.getFullYear() + 543;
            const thaiMonthNames = [
              '‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå', '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°', '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô', '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°', '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô',
              '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°', '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô', '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°', '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô', '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'
            ];
            const thaiMonth = thaiMonthNames[date.getMonth()];
            
            // ‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á input ‡πÄ‡∏õ‡πá‡∏ô "‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏° 2568"
            monthInput.value = `${thaiMonth} ${thaiYear}`;
            
            // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡∏£‡∏¥‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (2025-10)
            const realValue = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;
            monthInput.setAttribute('data-value', realValue);
          }
        },
        onReady: function(selectedDates, dateStr, instance) {
          // ‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà input
          monthInput.addEventListener('click', function() {
            instance.open();
          });
        }
      });
    }

    // ===== Mode Switching =====
    function showMode(mode) {
      if (mode === 'create') {
        // ‡∏™‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÇ‡∏´‡∏°‡∏î‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• + Reset ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÉ‡∏´‡πâ‡∏ß‡πà‡∏≤‡∏á
        resetForm();
        document.getElementById('createSection').classList.remove('hidden');
        document.getElementById('manageSection').classList.add('hidden');
        document.getElementById('btnModeCreate').classList.add('active');
        document.getElementById('btnModeManage').classList.remove('active');
      } else {
        // ‡∏™‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÇ‡∏´‡∏°‡∏î‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£
        document.getElementById('createSection').classList.add('hidden');
        document.getElementById('manageSection').classList.remove('hidden');
        document.getElementById('btnModeCreate').classList.remove('active');
        document.getElementById('btnModeManage').classList.add('active');
      }
    }

    // ===== Reset Form =====
    function resetForm() {
      f.reset();
      tbody.innerHTML = '';
      addRow();
      document.getElementById('preview').classList.remove('show');
      f.classList.remove('hidden');
      
      // Reset date pickers
      if (datePickerInstance) {
        datePickerInstance.setDate('today');
      }
      if (monthPickerInstance) {
        monthPickerInstance.clear();
      }
    }

    // ===== Add Row =====
    function addRow() {
      const id = 'act-' + Date.now() + '-' + Math.random().toString(16).slice(2);
      const tr = document.createElement('tr');
      const optsProject = Object.keys(activityMap).map(k => `<option value="${k}">${k}</option>`).join('');
      
      tr.innerHTML = `
        <td>
          <select name="key_project[]" onchange="updateActivities(this,'${id}')" required>
            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Key Project --</option>
            ${optsProject}
          </select>
        </td>
        <td>
          <select name="key_activity[]" id="${id}" required>
            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Key Activity --</option>
          </select>
        </td>
        <td><textarea name="detail[]" rows="3" required></textarea></td>
        <td><input type="number" name="manday[]" step="0.01" min="0" required></td>
        <td style="text-align:center">
          <button type="button" class="btn danger" onclick="this.closest('tr').remove()" style="padding:8px 12px">‡∏•‡∏ö</button>
        </td>
      `;
      tbody.appendChild(tr);
    }

    window.updateActivities = function(sel, targetId) {
      const v = sel.value;
      const target = document.getElementById(targetId);
      target.innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Key Activity --</option>';
      (activityMap[v] || []).forEach(act => {
        const o = document.createElement('option');
        o.value = act;
        o.textContent = act;
        target.appendChild(o);
      });
    };

    document.getElementById('btnAdd').onclick = addRow;

    // ===== Preview =====
    document.getElementById('btnPreview').onclick = () => {
      if (!f.reportValidity()) return;
      
      const fd = new FormData(f);
      const projects = [...f.querySelectorAll('select[name="key_project[]"]')].map(el => el.value);
      const activities = [...f.querySelectorAll('select[name="key_activity[]"]')].map(el => el.value);
      const details = fd.getAll('detail[]');
      const mandays = fd.getAll('manday[]');
      
      const monthDisplay = document.getElementById('month').value;
      
      let html = `
        <p><strong>‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•:</strong> ${fd.get('name')}</p>
        <p><strong>‡∏ù‡πà‡∏≤‡∏¢/‡πÅ‡∏ú‡∏ô‡∏Å:</strong> ${fd.get('department')}</p>
        <p><strong>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô/‡∏á‡∏≤‡∏ô:</strong> ${fd.get('unit')}</p>
        <p><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å:</strong> ${fd.get('date')}</p>
        <p><strong>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô):</strong> ${monthDisplay}</p>
      `;
      
      html += '<table style="margin-top:20px"><thead><tr><th>Project</th><th>Activity</th><th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th><th>Manday</th></tr></thead><tbody>';
      projects.forEach((p, i) => {
        html += `<tr>
          <td>${p}</td>
          <td>${activities[i] || ''}</td>
          <td>${details[i] || ''}</td>
          <td>${mandays[i] || ''}</td>
        </tr>`;
      });
      html += '</tbody></table>';
      
      document.getElementById('previewBody').innerHTML = html;
      f.classList.add('hidden');
      document.getElementById('preview').classList.add('show');
    };

    document.getElementById('btnBack').onclick = () => {
      document.getElementById('preview').classList.remove('show');
      f.classList.remove('hidden');
    };

    // ===== Form Submit =====
    f.addEventListener('submit', async (e) => {
      e.preventDefault();
      // ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£ - ‡πÉ‡∏´‡πâ‡∏Å‡∏î Confirm ‡πÉ‡∏ô Preview ‡πÅ‡∏ó‡∏ô
    });

    document.getElementById('btnConfirm').onclick = async () => {
      if (isSending) return;
      isSending = true;
      
      const submitBtn = document.getElementById('btnSubmit');
      const submitText = document.getElementById('submitText');
      const submitLoading = document.getElementById('submitLoading');
      
      submitText.classList.add('hidden');
      submitLoading.classList.remove('hidden');
      
      try {
        const result = await sendToMake();
        showSuccessModal(result.count);
        resetForm(); // Reset ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÉ‡∏´‡πâ‡∏ß‡πà‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
      } catch (err) {
        alert('‚ùå ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ' + err.message);
      } finally {
        isSending = false;
        submitText.classList.remove('hidden');
        submitLoading.classList.add('hidden');
      }
    };

    // ===== Send Data =====
    async function sendToMake() {
      const fd = new FormData(f);
      const keyProjects = [...document.querySelectorAll('select[name="key_project[]"]')].map(el => el.value);
      const keyActivities = [...document.querySelectorAll('select[name="key_activity[]"]')].map(el => el.value);
      const details = fd.getAll('detail[]');
      const mandays = fd.getAll('manday[]');
      
      const recordId = crypto.randomUUID ? crypto.randomUUID() : ('rec_' + Date.now());
      const nowIso = new Date().toISOString();
      
      // ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤ data-value ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ (2025-10)
      const monthValue = document.getElementById('month').getAttribute('data-value') || '';
      
      const records = keyProjects.map((kp, i) => ({
        recordId,
        timestamp: nowIso,
        date: fd.get('date'),
        month: monthValue,
        name: fd.get('name'),
        department: fd.get('department'),
        unit: fd.get('unit'),
        key_project: kp || '',
        key_activity: keyActivities[i] || '',
        detail: details[i] || '',
        manday: parseFloat(mandays[i] || 0)
      })).filter(r => r.key_project || r.key_activity || r.detail);
      
      if (!records.length) throw new Error('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á');
      
      const out = new FormData();
      out.append('value', JSON.stringify({ secret: SHARED_SECRET, records }));
      
      const res = await fetch(MAKE_WEBHOOK_URL, { method: 'POST', body: out });
      if (res.status < 200 || res.status >= 300) throw new Error(`HTTP Error: ${res.status}`);
      
      return { success: true, count: records.length };
    }

    // ===== Success Modal =====
    function showSuccessModal(count) {
      document.getElementById('successMessage').textContent = `‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å ${count} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`;
      document.getElementById('successModal').classList.add('show');
    }

    function closeSuccessModal() {
      document.getElementById('successModal').classList.remove('show');
    }

    // ===== Manage Data Functions =====
    async function loadMyData() {
      const name = document.getElementById('searchName').value.trim();
      if (!name) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠');
        return;
      }
      
      const listDiv = document.getElementById('dataList');
      listDiv.innerHTML = '<p style="text-align:center;color:#666">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤...</p>';
      
      try {
        const url = `${APPS_SCRIPT_URL}?action=list&name=${encodeURIComponent(name)}`;
        const res = await fetch(url);
        const data = await res.json();
        
        if (!data.length) {
          listDiv.innerHTML = '<p style="text-align:center;color:#999">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>';
          return;
        }
        
        let html = '<div class="data-table"><table><thead><tr><th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th><th>Project</th><th>Activity</th><th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th><th>Manday</th><th style="width:150px">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th></tr></thead><tbody>';
        
        data.forEach(row => {
          html += `
            <tr id="row-${row.rowNumber}">
              <td>${row.date}</td>
              <td>${row.key_project}</td>
              <td>${row.key_activity}</td>
              <td><textarea id="detail-${row.rowNumber}">${row.detail}</textarea></td>
              <td><input type="number" id="manday-${row.rowNumber}" value="${row.manday}" step="0.01"></td>
              <td>
                <button class="btn primary" style="padding:8px 12px;margin:2px" onclick="updateRow(${row.rowNumber})">üíæ</button>
                <button class="btn danger" style="padding:8px 12px;margin:2px" onclick="deleteRow(${row.rowNumber})">üóëÔ∏è</button>
              </td>
            </tr>
          `;
        });
        
        html += '</tbody></table></div>';
        listDiv.innerHTML = html;
      } catch (err) {
        console.error(err);
        listDiv.innerHTML = '<p style="text-align:center;color:red">‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î</p>';
      }
    }

    async function updateRow(rowNumber) {
      const detail = document.getElementById(`detail-${rowNumber}`).value;
      const manday = document.getElementById(`manday-${rowNumber}`).value;
      
      try {
        const url = `${APPS_SCRIPT_URL}?action=update&rowNumber=${rowNumber}&detail=${encodeURIComponent(detail)}&manday=${manday}`;
        await fetch(url);
        alert('‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
      } catch (err) {
        alert('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î');
      }
    }

    async function deleteRow(rowNumber) {
      if (!confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö?')) return;
      
      try {
        const url = `${APPS_SCRIPT_URL}?action=delete&rowNumber=${rowNumber}`;
        await fetch(url);
        document.getElementById(`row-${rowNumber}`).remove();
        alert('‚úÖ ‡∏•‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
      } catch (err) {
        alert('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î');
      }
    }
  </script>
</body>
</html>
